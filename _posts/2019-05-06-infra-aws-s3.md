---
layout: post
comments: true
title: "AWS-S3에 대해서 알아보기"
date: 2019-05-06 21:12:00 +0900
categories: infra
description: AWS의 S3에 대한 이야기
---

# AWS의 S3란?
## S3란 Simple Storage Services의 줄인말이다.

<p>자 이전 포스트에서 AWS의 EC2에 대해서 설명을 해보았고, 접속까지 해보았다.<br>
이제 S3에 대해서 설명을 좀 하고자 한다.</p>
<p>그전에 우리는 다음과 같은 가정을 세워 생각을 해보도록 하자.<br>
나는 어떠한 <strong><u>중요한 파일</u></strong>을 가지고 있다. 이 파일을 잃어버리면 큰일 난다. 그래서 나는 이 파일을 잃어버리면 안되겠다고 생각한다.<br>
만약 하드가 고장 날 수도 있고, 어떠한 폴더에 넣어뒀는데 그 폴더가 어디 있는지 기억이 안 나 잃어버리는 경우...<br>
이러한 위험성을 좀 해소하고자 <u>S3</u>를 사용하기로 마음을 먹는다.<br>
S3는 내구성이 <strong>99.999999999%</strong>이다. 이 말을 해석하자면 내가 S3에 파일을 업로드 한 경우에는 3개 이상의 여러 지역에 저장이 된다.<br>
한 건물이 무너져도 다른 지역에서 그 파일을 보존하고 있기 때문에 거의 파일을 잃어버리거나 증발할 경우는 없는 이러한 내구성을 가지고 있다.<br>
또한 S3는 이 세상 어디서든지 <u>인터넷</u>만 연결되어 있으면 접근 가능하다.<br>
또 내가 업로드한 파일이 5년 뒤 나 10년 뒤에 쓸모가 없어 없애버렸으면 좋겠다, 6개월 뒤 더 저렴한 저장 공간(버킷)으로 옮겼으면 좋겠다는 자동화, 버전 관리 등등
이런 기능뿐만 아니라 여러 가지 기능들을 제공하고 있다.<del>(내가 계속 AWS 좋다. AWS 써라. 이런 말 만하니까 광고하는 것 같지만 AWS의 광고하는 것이 아니니 오해말기 바람^^..)</del></p>




<p>이제 S3가 무엇인지와 S3를 활용해 웹을 띄워 보도록 하자!</p>
<p>그럼 지금부터 AWS의 S3를 이용해서 저장소를 한번 활용 해보도록 하겠다.</p>
<p><font size="2em">본 블로그는 12개월 무료인 프리 티어에 대해서 설명드리며, 또 한 이번 포스트는 AWS에 이미 가입되어 있는 상태에서 진행되는 점 알려드립니다.</font></p><br><br><br> 시작합니다.

<img src="{{site.static_url}}/img/infra/infra-aws-s3-1.png">
- 서비스 > 스토리지 > S3
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-2.png">
<p>S3 서비스에서는 저장소하나를 생성 시키면 그 이름을 저장소라 부르지 않고 버킷(bucket)이라고 부른다.</p>
- 버킷 > 버킷 만들기
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-3.png">
<p>버킷 이름은 전 세계 고유한 이름을 갖는다. 따라서 중복된 이름이 있을 수 있다.</p>
- 버킷 이름을 설정
- 다음
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-4.png">
<p></p>
- 유형 - t2.micro (프리 티어 사용 가능) 확인
- 검토 및 시작 (세부 설정은 지금은 필요 없으니 넘어가도록 하겠다.)
이렇게 하면 우리는 1개의 CPU, 1GB 메모리가 달린 AWS 컴퓨터를 장만하기 시작한다.<br>
다른 유형에 대해서는 프리티 어가 아닌 경우 시간 또는 분 단위로 요금이 나온다, 이 경우에 대해서는 제일 아래에서 설명하겠다.
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-5.png">
- 시작하기
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-6.png">
- 새 키 페어 생성
- .pem이라는 확장자를 가진 키이다. 잃어버리지 않도록 주의하며 키 이름을 설정하고 다운로드
- 인스턴스 시작<br>
키 페어는 오직 지금 밖에 다운로드만 가능하다. 그러니 잃어 버리지 않도록 주의하자. 잃어버렸을 경우 방법이 있다. 그러나 좀 초급자에겐 어려울 수 있으니 여기서는 설명하지 않도록 하겠다. (그냥 잃어버리지 말길 바란다...)
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-7.png">
시작한 뒤 인스턴스를 보게 되면 'Pending' 이였다가 잠시 뒤 'running'으로 바뀌게 될 것이다.<br>
이 상태가 되면 우리는 지금 AWS의 컴퓨터 한 대를 장만하게 된 것이다. 참 쉽죠?
<br><br><br><br>
<p>지금부터 s3를 시작했으니 돈이 나가기 시작할 것이다. 그러나 걱정하지 말자. <del>우리는 12개월 동안 무료로 사용할 수 있는 프리 티어이니까!</del>자 이제 인스턴스가 돈이 안 나가게 하는 방법에 대해서 알아보자. 의외로 간단하다.</p>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-8.png">
- 해당 인스턴스 오른쪽 클릭 > 인스턴스 상태 > 중지<br>
이렇게 하면 해당 인스턴스가 최소 몇 초에서 최대 5분 내로 인스턴스의 상태가 'Stopped'의 상태가 된다.
<br><br><br><br>

<p>이제 s3 인스턴스를 생성하고 껐다 켰다를 할 수 있게 되었다. 이제 s3에 접속을 해봐야 하지 않는가!</p>

<p><strong>Mac OS X</strong>에서 접속하는 방법과 <strong>Windows 10</strong>에서 접속하는 방법. 이 두 가지에 대해서 설명하고자 한다.</p>

## Mac OS X 접속 방법

<img src="{{site.static_url}}/img/infra/infra-aws-s3-11.png">
- 생성한 인스턴스 클릭 > 퍼블릭 DNS 기억
<br><br><br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-10.png">
- 터미널 오픈 > 인스턴스를 생성할 때 다운로드 받은 키가 존재하는 폴더로 이동
```
    # chmod 400 <다운로드 받은 키.pem>
    SSH가 작동하려면 키가 공개적으로 표시되지 않아야 한다. 필요할 경우 이 명령을 사용.
    # sudo ssh -i "<다운로드 받은 키.pem>" <본인 인스턴스의 퍼블릭 DNS>
    sudo 명령어로 관리자 권한으로 실행을 하게 될 시 비밀번호를 물어본다. 이 경우 Mac 비밀번호이다.
```
<br>

## Windows 10 접속 방법
본 블로그에서는 [Putty 프로그램](https://www.putty.org/)을 이용해서 접속을 할 것이다.
```
    시작 > 모든 프로그램 > puTTY > PuTTYgen 선택
```
<img src="{{site.static_url}}/img/infra/infra-aws-s3-13.png">
- 생성 키의 종류 - RSA
- Load
<br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-12.png">
- All Files(*.*) > "다운로드 받은 키"
- Save Private Key(PuTTY가 사용할수 있는 형식으로 .ppk 비공개 키 저장)
<br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-14.png">
- Host Name(or IP address) : 본인의 인스턴스의 퍼블릭 DNS
- Port : 22
- Connection type : SSH
- Category > Connection > SSH > auth
<br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-15.png">
- Browse.. > 비공개로 저장했던 키를 검색
- Open
<br><br>

<img src="{{site.static_url}}/img/infra/infra-aws-s3-16.png">
<p>SSH를 서버에 등록하겠냐는 문구가 뜨면 당연히 Yes를 클릭하고 로그인한다.<br>
로그인 ID : s3-user<br></p>
<br><br><br>
<p><font size="5em">축하한다. 여러분들은 이제 AWS의 컴퓨터 한대를 빌려 접속을 성공했다!</font></p>
<br><br><br><br>

<p>다음으론 <font size="5em"><u>s3 요금</u></font>에 대해서 한번 알아보도록 하자.</p>

<p>당연하겠지만 빌려 쓰는 것이기 때문에 사용료를 지불해야 한다. 사용하는 방식(비용을 지불하려고 하는 형태)에는 4가지의 방식이 있다.</p>

[AWS 요금 형식](https://aws.amazon.com/ko/s3/pricing/) 링크를 들어가 보면 4가지의 요금 형식이 있지만 2가지만 설명하겠다.<br>
### 1. 온디멘드
<p>실행되고 있는 인스턴스에 따라 대게 시간당으로 비용을 지불하게 된다.</p>

### 2. 예약 인스턴스
<p>인스턴스를 실행하는 것을 예약으로 설정하여 만약 어느 수요가 많다는 생각이 드는 시간대에 온 디멘드 방식보단 예약 인스턴스를 방식을 사용하여 계속 켜놓는 것보다 필요할 때만 인스턴스를 켜기 때문에 비용을 최대 75% 정도까지 절약할 수 있다. <br><br>나머지 2 방식은 독자께서 이해해보려 노력하길 바라며 (총총...)<br><br></p>

## s3에 대한 다양한 요금
<img src="{{site.static_url}}/img/infra/infra-aws-s3-9.png">
<p>이 그림을 보고 간단하게 설명하고 넘어가고자 한다. 프리 티어 기준으로 생성한 인스턴스를 보도록 하겠다.<br>
보다시피 CPU 1개, 메모리 1GB 짜리를 사용하는데 시간당 요금이 '시간당 0.0144 USD' 즉, 1달러(한화 약 1200원)를 쓰려면 69.4시간을 사용해야 1달러가 나온다는 말이다.<br>
이 말이 무슨 말이냐고? <del> 본 블로거는 멍청한 짓을 한 것이죠.</del> 서버 컴퓨터 하나 맞추려고 50만 원 정도의 돈을 투자해서 맞췄는데... 단돈 1200원이라는 돈으로 70시간의 컴퓨터를 빌릴 수 있다니... 여기서 새삼 한 번 더 AWS에 대해 놀랬음.<br>
물론 본인이 개인 서비스를 진행하고자 하는데 사용자 수가 많아지면 당연히 그림에 나와 있는 사양 가지고는 터무니가 없다고 느낄 것이다. 그래서 밑으로 내려다보면 자신에게 맞는 사양을 택해서 요금을 내면 된다. 다른 사양에 대해서는 그대들이 알아서 잘 보도록 하길 바란다.</p>

## 지역(Region)에 대해서 설명
![aws-region](/img/infra/infra-aws-region.png)
[AWS region 참조](http://jayendrapatil.com/aws-regions-availability-zones-and-edge-locations/) 관련 이미지<br><br>
<p>비용 지불 형식에 대해서 이해했다면 이제 이전 포스트에 말했던 리전에 관해서 설명을 하고자 한다.<br>
위를 봤던 그림처럼 여러 리전에 AWS가 있다고 했다. 나중에 보면 알겠지만 내가 한국에 있다고 꼭 '서울' 리전을 선택해서 사용할 필요는 없다. 이러한 리전을 정하는 기준에 대해서는 이렇게 생각하면 좋겠다. <br>
"내가 프로그램을 제작하였을 때 이 프로그램을 어느 리전에 있는 사용자가 많이 사용할 것인가?" 이러한 질문에서 당연히 한국 사람들이 많이 사용할 것이라면 '서울' 리전을 선택해서 사용하면 되고, 유럽 사람들이 많이 사용할 것이라면 '유럽' 리전을 선택해서 사용하면 된다. 왜냐하면 한국 사람들이 많이 사용하는데 '유럽' 리전을 선택해서 사용하다 보면 한국에서 유럽까지 통신하는 거리가 있기 때문에 조금 느릴 수가 있다. (리전 선택은 본인이 선택하는 것이기 때문에 느리든 말든 알아서 해도 무관하다... 내 생각은 그렇다는 것이다.)</p>

<p><br>s3에 대해서 좀 더 생각나면 쓰도록 하며 S3에 대한 이야기를 시작하려면 다음 블로그로 이동합시다!</p>

## [S3에 대한 이야기!](https://msnodeve.github.io/infra/2019-05-01-infra-aws-s3/)

